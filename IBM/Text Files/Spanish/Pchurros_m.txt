For the pistachio custard, put the pistachios in saucepan of boiling water and simmer for 2 minutes. Drain and set aside until cool enough to handle. The skins will now slip off easily, either by peeling the nuts individually or by rubbing them between sheets of kitchen paper.
Meanwhile, preheat the oven to 200C/180C Fan/Gas 6.
Place the skinned nuts on a baking tray and bake for 5 minutes, until lightly toasted. Set aside to cool.
Set aside half the toasted nuts for decorating. Put the remaining nuts and the icing sugar in a food processor and pulse to a fine powder.
In a saucepan, warm the milk until just under the boiling point.
Meanwhile, add the egg yolks and almond extract to the powdered nuts. Pulse or stir until well combined, then slowly add the hot milk until combined. Pour the mixture into a saucepan and warm gently, stirring constantly, until very thick. Stir in the butter until melted and well incorporated.
Push the mixture through a sieve to remove any lumps. Stir in a little green food colouring, if using, then add melted white chocolate. Cover the surface with cling film, pressing it down to prevent a skin forming. Store in the fridge until ready to use.
For the churros, put the sugar, butter, salt and 325ml/11fl oz water in a medium saucepan. Bring to the boil, tip in all the flour and beat until the mixture comes away from the sides of the pan. Remove from the heat and set aside to cool (to prevent the eggs from curdling when you add them). Add the eggs one at a time, beating well after each addition. Stir in the vanilla extract.
Preheat a deep-fat fryer to 190C or heat a large heavy based pan filled half-full with oil until it reaches 190C on a cook’s thermometer. (CAUTION: hot oil can be dangerous. Do not leave unattended.) Line three baking trays with baking parchment.
Transfer the cooled mixture to a large piping bag fitted with large star nozzle. Pipe out 10cm/4in lines of the churros mixture onto the prepared baking trays. When piping you can cut the ends with scissors to create a neat finish. Place in the freezer for 10 minutes to set the shape.
Carefully lower the churros into the hot oil. (CAUTION: do not allow the oil to get too hot as this may cause the churros to explode. Protect yourself from splashes of hot oil and keep your face away from the pan.) Fry in batches of four for approximately 6 minutes, turning halfway through, or until golden-brown. Remove the churros with a slotted spoon and drain on kitchen paper.
Pour the vanilla sugar onto a large plate and roll the cooked churros in the sugar to coat.
Fit a piping bag with a small plain piping nozzle and fill with the pistachio custard. Make a hole the length of the churro using a skewer, then fill the churros. Repeat for all the churros.
To finish the churros, melt the white chocolate. Meanwhile, finely chop the reserved pistachios. Dip each end of the churros in the melted chocolate and sprinkle with chopped pistachios. Place on wire racks while the chocolate cools and sets.
For the chocolate sauce, put the cream in a small saucepan and heat until just below boiling point. Put the dark chocolate in a small bowl and pour over the hot cream. Stir until the chocolate has melted, then stir in the almond liqueur. Pour the sauce into a small bowl and serve with the churros.